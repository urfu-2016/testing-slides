<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Unit</title>

    <link rel="stylesheet" href="../css/reveal.css">
    <link rel="stylesheet" href="../css/theme/yandex.css">
    <link rel="stylesheet" href="../css/user.css">
    <link rel="stylesheet" href="../css/zenburn.css">
</head>
<body>
<div class="reveal"><div class="slides">

<section>
    <h1>–ê–≤—Ç–æ—Ç–µ—Å—Ç—ã</h1>
    <p>–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. TDD. Mock. Nock. Sinon</p>
    <p class="author">–ñ–∏–≥–∞–ª–æ–≤ –°–µ—Ä–≥–µ–π</p>
</section>

<section>
    <section>
        <h3>1. –°–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤ –ø–∏—Å–∞—Ç—å?</h3>
        <ul>
            <li class="fragment">–ß—Ç–æ–±—ã –ø–æ–∫—Ä—ã—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</li>
            <li class="fragment">–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">1. –°–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤ –ø–∏—Å–∞—Ç—å?</span> –ü—Ä–∏–º–µ—Ä</h3>
        <pre class="js size-S"><code data-trim>
it(`should throw error when dice is string`, () => {
  const cb = () => getPokerHand('hello');

  assert.throws(cb, /Dice is not an array/);
});

it(`should throw error when dice is empty`, () => {
  const cb = () => getPokerHand();

  assert.throws(cb, /Dice is not an array/);
});
        </code></pre>
    </section>

    <section>
        <h3>–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤</h3>
        <small>–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–ª–Ω–æ—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</small>
    </section>

    <section>
        <h3>–ë–µ–ª—ã–π —è—â–∏–∫</h3>
        <img src="images/white-box.jpg" alt="White box">
    </section>

    <section>
        <h3>–ë–µ–ª—ã–π —è—â–∏–∫</h3>
        <blockquote>
            –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥:
            –∫–∞–∂–¥—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω —Ö–æ—Ç—è–±—ã –æ–¥–∏–Ω —Ä–∞–∑.
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">–ë–µ–ª—ã–π —è—â–∏–∫</span> –ü—Ä–∏–º–µ—Ä</h3>
        <pre class="js size-S"><code data-trim data-noescape>
function getPokerHand(dice) {
    if (dice.length != 5)
        <span class="fragment grow" data-fragment-index="1">throw new Error('Wrong amount of dices');</span>

    var combo = dice.reduce(function(acc, val) {
        if(<span class="fragment grow" data-fragment-index="2">val < 1</span> || <span class="fragment grow" data-fragment-index="3">val > 6</span> || <span class="fragment grow" data-fragment-index="4">!Number.isInteger(val)</span>)
            throw new Error('Dice should be int from 1 to 6');

        <span class="fragment grow" data-fragment-index="5">/* ... */</span>
    });
}
        </code></pre>
    </section>

    <section>
        <h3>–ß–µ—Ä–Ω—ã–π —è—â–∏–∫</h3>
        <img src="images/black-box.jpg" alt="Black box">
    </section>

    <section>
        <h3>–ß–µ—Ä–Ω—ã–π —è—â–∏–∫</h3>
        <blockquote>
            –¢–µ—Å—Ç-–∫–µ–π—Å—ã –≤—ã–±–∏—Ä–∞–µ–º –∏—Å—Ö–æ–¥—è –∏–∑ —Ç–æ–≥–æ, –∫–∞–∫ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∞
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">–ß–µ—Ä–Ω—ã–π —è—â–∏–∫</span> –ü—Ä–∏–º–µ—Ä</h3>
        <ul>
            <li class="fragment">–Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è –Ω–µ –º–∞—Å—Å–∏–≤</li>
            <li class="fragment">–Ω–∞ –≤—Ö–æ–¥ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–∞—ë—Ç—Å—è</li>
            <li class="fragment">—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –±–æ–ª—å—à–µ 5</li>
            <li class="fragment">—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –º–µ–Ω—å—à–µ 5</li>
            <li class="fragment">—ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –Ω–µ —á–∏—Å–ª–æ</li>
            <li class="fragment">—ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –º–µ–Ω—å—à–µ 1</li>
            <li class="fragment">—ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –±–æ–ª—å—à–µ 6</li>
            <li class="fragment">—ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –¥—Ä–æ–±–Ω–æ–µ —á–∏—Å–ª–æ</li>
            <li class="fragment">...</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">–ß–µ—Ä–Ω—ã–π —è—â–∏–∫</span> –ü—Ä–∏–º–µ—Ä</h3>
        <ul>
            <li class="fragment">–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `–ö–∞—Ä–µ` –¥–ª—è [1, 1, 1, 1, 2]</li>
            <li class="fragment">–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `–§—É–ª–ª —Ö–∞—É—Å` –¥–ª—è [1, 1, 1, 2, 2]</li>
            <li class="fragment">–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `–¢—Ä–æ–π–∫–∞` –¥–ª—è [1, 1, 1, 2, 3]</li>
            <li class="fragment">–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `–î–≤–µ –ø–∞—Ä—ã` –¥–ª—è [1, 1, 2, 2, 3]</li>
            <li class="fragment">–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `–ü–∞—Ä–∞` –¥–ª—è [1, 1, 2, 3, 4]</li>
            <li class="fragment">–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `–ù–∞–∏–≤—ã—Å—à–µ–µ –æ—á–∫–æ` –¥–ª—è [1, 2, 3, 4, 5]</li>
            <li class="fragment">...</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>2. –¢–µ—Å—Ç—ã –ø–æ—Ö–æ–∂–∏</h3>
    </section>

    <section>
        <pre class="js size-S"><code data-trim data-noescape>
it('should return `–ü–æ–∫–µ—Ä` for [6, 6, 6, 6, 6]', () => {
    const actual = getPokerHand(<span class="fragment grow" data-fragment-index="1">[6, 6, 6, 6, 6]</span>);

    assert.equal(actual, <span class="fragment grow" data-fragment-index="1">'–ü–æ–∫–µ—Ä'</span>);
});
it('should return `–ö–∞—Ä–µ` for [6, 6, 3, 6, 6]', () => {
    const actual = getPokerHand(<span class="fragment grow" data-fragment-index="1">[6, 6, 3, 6, 6]</span>);

    assert.equal(actual, <span class="fragment grow" data-fragment-index="1">'–ö–∞—Ä–µ'</span>);
});
it('should return `–§—É–ª–ª —Ö–∞—É—Å` for [6, 1, 1, 6, 6]', () => {
    const actual = getPokerHand(<span class="fragment grow" data-fragment-index="1">[6, 1, 1, 6, 6]</span>);

    assert.equal(actual, <span class="fragment grow" data-fragment-index="1">'–§—É–ª–ª —Ö–∞—É—Å'</span>);
});
        </code></pre>
    </section>

    <section>
        <pre class="js size-S"><code data-trim data-noescape>
function runSuccessTest(dice, expected) {
    const actual = getPokerHand(dice);

    assert.equal(actual, expected);
}
        </code></pre>
        <pre class="js size-S fragment"><code data-trim data-noescape>
it('should return `–ü–æ–∫–µ—Ä` for [6, 6, 6, 6, 6]', () => {
    runSuccessTest([6, 6, 6, 6, 6], '–ü–æ–∫–µ—Ä');
});

it('should return `–ö–∞—Ä–µ` for [6, 6, 3, 6, 6]', () => {
    runSuccessTest([6, 6, 3, 6, 6], '–ö–∞—Ä–µ');
});

it('should return `–§—É–ª–ª —Ö–∞—É—Å` for [6, 1, 1, 6, 6]', () => {
    runSuccessTest([6, 1, 1, 6, 6], '–§—É–ª–ª —Ö–∞—É—Å');
});
        </code></pre>
    </section>

    <section>
        <pre class="js size-S"><code data-trim data-noescape>
function runSuccessTest(dice, expected) {
    return () => {
        const actual = getPokerHand(dice);

        assert.equal(actual, expected);
    }
}
        </code></pre>
        <pre class="js size-S fragment"><code data-trim data-noescape>
it('should return `–ü–æ–∫–µ—Ä` for [6, 6, 6, 6, 6]',
    runSuccessTest([6, 6, 6, 6, 6], '–ü–æ–∫–µ—Ä'));

it('should return `–ö–∞—Ä–µ` for [6, 6, 3, 6, 6]',
    runSuccessTest([6, 6, 3, 6, 6], '–ö–∞—Ä–µ'));

it('should return `–§—É–ª–ª —Ö–∞—É—Å` for [6, 1, 1, 6, 6]',
    runSuccessTest([6, 1, 1, 6, 6], '–§—É–ª–ª —Ö–∞—É—Å'));
        </code></pre>
    </section>

    <section>
        <pre class="js size-S"><code data-trim data-noescape>
[
    { dice: [6, 6, 6, 6, 6], expected: '–ü–æ–∫–µ—Ä' },
    { dice: [6, 6, 3, 6, 6], expected: '–ö–∞—Ä–µ' },
    { dice: [6, 1, 1, 6, 6], expected: '–§—É–ª–ª —Ö–∞—É—Å' },
].forEach(test =>
    it(`should return ${test.expected} for [${test.dice}]`,()=>{
        const actual = getPokerHand(test.dice);

        assert.equal(actual, test.expected);
    }
);
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>–ü–æ–¥—Ö–æ–¥—ã –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h3>
    </section>

    <section>
        <h3>Test Last Development</h3>
        <small style="display: block;">TLD</small>
        <ol>
            <li class="fragment">–ù–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥</li>
            <li class="fragment">–ü–æ–∫—Ä—ã—Ç—å –∫–æ–¥ —Ç–µ—Å—Ç–∞–º–∏</li>
            <li class="fragment">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç</li>
        </ol>
    </section>

    <section>
        <h3><span class="gray">TLD</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h3>
        <ul>
            <li class="fragment">–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å</li>
            <li class="fragment">–ù–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤</li>
            <li class="fragment">–õ–µ–≥–∫–æ –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>Test Driven Development</h3>
        <small style="display: block;">TDD</small>
        <ol>
            <li class="fragment">–û–ø–∏—Å—ã–≤–∞–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–µ</li>
            <li class="fragment">–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç</li>
            <li class="fragment">–†–µ–∞–ª–∏–∑—É–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∫–æ–¥–µ</li>
            <li class="fragment">–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç</li>
            <li class="fragment">–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥</li>
        </ol>
    </section>

    <section>
        <h3>Test Driven Development</h3>
        <img src="images/tdd.jpeg" alt="tdd">
    </section>

    <section>
        <h3><span class="gray">TDD</span> –ü—Ä–∏–º–µ—Ä</h3>
        <ul>
            <li>–Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è –Ω–µ –º–∞—Å—Å–∏–≤</li>
            <li>—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –±–æ–ª—å—à–µ 5</li>
            <li>—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –º–µ–Ω—å—à–µ 5</li>
            <li>...</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 1.1 –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
describe('getPokerHand', () => {
    it('should throw error when dice is not array', () => {
        const cb = () => getPokerHand('not array');

        assert.throws(cb, /Arguments is not array/);
    });
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 1.2 –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç</h3>
        <pre class="js console"><code data-trim>
getPokerHand
  1) should throw error when dice is not array


0 passing (9ms)
1 failing

1) getPokerHand should throw error when dice is not array:
   TypeError: getPokerHand is not a function
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 1.3 –ö–æ–¥</h3>
        <pre class="js size-S"><code data-trim>
function getPokerHand(dice) {
    if(!Array.isArray(dice)) {
        throw new Error('Arguments is not array');
    }
}
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 1.4 –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç</h3>
        <pre class="js console"><code data-trim>
getPokerHand
  ‚úì should throw error when dice is not array


1 passing (6ms)
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 1.5 –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥</h3>
        <p class="fragment">–í—Å—ë –∏ —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ üëå</p>
    </section>

    <section>
        <ul>
            <li>‚úì –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è –Ω–µ –º–∞—Å—Å–∏–≤</li>
            <li>—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –±–æ–ª—å—à–µ 5</li>
            <li>—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –º–µ–Ω—å—à–µ 5</li>
            <li>...</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 2.1 –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
        describe('getPokerHand', () => {
            it('should throw error when dice is not array', /*...*/);
            it('should throw error when dice length great 5', () => {
                const cb = () => getPokerHand([1, 2, 3, 4, 5, 6]);

                assert.throws(cb, /Arguments length not equal 5/);
            });
        });
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 2.2 –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç</h3>
        <pre class="js console"><code data-trim>
getPokerHand
  ‚úì should throw error when dice is not array
  1) should throw error when dice length great 5


1 passing (8ms)
1 failing

1) getPokerHand should throw error when dice length great 5:
   AssertionError: Missing expected exception..
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 2.3 –ö–æ–¥</h3>
        <pre class="js size-S"><code data-trim>
function getPokerHand(dice) {
    if(!Array.isArray(dice)) {
        throw new Error('Arguments is not array');
    }

    if (dice.length > 5) {
        throw new Error('Arguments length not equal 5');
    }
}
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 2.4 –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç</h3>
        <pre class="js console"><code data-trim>
getPokerHand
  ‚úì should throw error when dice is not array
  ‚úì should throw error when dice length great 5


2 passing (7ms)
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 2.5 –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥</h3>
        <p class="fragment">–ü–æ-–ø—Ä–µ–∂–Ω–µ–º—É –≤—Å—ë —Ö–æ—Ä–æ—à–æ üëå</p>
    </section>

    <section>
        <ul>
            <li>‚úì –Ω–∞ –≤—Ö–æ–¥ –ø–æ–¥–∞–µ—Ç—Å—è –Ω–µ –º–∞—Å—Å–∏–≤</li>
            <li>‚úì —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –±–æ–ª—å—à–µ 5</li>
            <li>—Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ –º–µ–Ω—å—à–µ 5</li>
            <li>...</li>
        </ul>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 3.1 –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
describe('getPokerHand', () => {
    it('should throw error when dice is not array', /*...*/);
    it('should throw error when dice length great 5', /*...*/);
    it('should throw error when dice length less 5', () => {
        const cb = () => getPokerHand([1, 2, 3, 4]);

        assert.throws(cb, /Arguments length not equal 5/);
    });
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 3.2 –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç</h3>
        <pre class="js console"><code data-trim>
getPokerHand
  ‚úì should throw error when dice is not array
  ‚úì should throw error when dice length great 5
  1) should throw error when dice length less 5


2 passing (9ms)
1 failing

1) getPokerHand should throw error when dice length less 5:
   AssertionError: Missing expected exception..
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 3.3 –ö–æ–¥</h3>
        <pre class="js size-S"><code data-trim>
function getPokerHand(dice) {
    if(!Array.isArray(dice)) {
        throw new Error('Arguments is not array');
    }

    if (dice.length > 5) {
        throw new Error('Arguments length not equal 5');
    }

    if (dice.length < 5) {
        throw new Error('Arguments length not equal 5');
    }
}
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 3.4 –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç</h3>
        <pre class="js console"><code data-trim>
getPokerHand
  ‚úì should throw error when dice is not array
  ‚úì should throw error when dice length great 5
  ‚úì should throw error when dice length less 5


3 passing (8ms)
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> 3.5 –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥</h3>
        <pre class="js size-S"><code data-trim>
function getPokerHand(dice) {
    if(!Array.isArray(dice)) {
        throw new Error('Arguments is not array');
    }

    if (dice.length !== 5) {
        throw new Error('Arguments length not equal 5');
    }
}
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">TDD</span> –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h3>
        <ul>
            <li class="fragment">100% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏</li>
            <li class="fragment">–ü—Ä–æ–¥—É–º–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</li>
            <li class="fragment">–ú–µ–Ω—å—à–µ –ª–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤</li>
            <li class="fragment">–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ üêû –Ω–∞ —Ä–∞–Ω–Ω–µ–π —Å—Ç–∞–¥–∏–∏</li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h3>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥—É–ª–µ–π</h3>
    </section>

    <section>
        <blockquote>
–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –≤ –∏–≥—Ä–µ "–ø–æ–∫–µ—Ä –Ω–∞ –∫–æ—Å—Ç—è—Ö"
        </blockquote>
    </section>

    <section>
        <h3>–†–µ—à–µ–Ω–∏–µ</h3>
        <pre class="js size-S"><code data-trim>
// playPoker.js

const getPokerHand = require('./getPokerHand');
const pokerHands = [
    '–ù–∞–∏–≤—ã—Å—à–µ–µ –æ—á–∫–æ',
    '–ü–∞—Ä–∞',
    '–î–≤–µ –ø–∞—Ä—ã',
    '–¢—Ä–æ–π–∫–∞',
    '–§—É–ª–ª —Ö–∞—É—Å',
    '–ö–∞—Ä–µ',
    '–ü–æ–∫–µ—Ä'
];

function playPoker(firstDice, secondDice) {/* ... */}
        </code></pre>
    </section>

    <section>
        <h3>–†–µ—à–µ–Ω–∏–µ</h3>
        <pre class="js size-S"><code data-trim>
// playPoker.js

function playPoker(firstDice, secondDice) {
    const first = getPokerHand(firstDice);
    const second = getPokerHand(secondDice);

    const compareHands =
        pokerHands.indexOf(first) -
        pokerHands.indexOf(second);

    return compareHands === 0
        ? '–ù–∏—á—å—è'
        : compareHands > 0 ? '–ü–µ—Ä–≤—ã–π' : '–í—Ç–æ—Ä–æ–π';
}
        </code></pre>
    </section>

    <section>
        <h3>–ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å?</h3>
    </section>

    <section>
        <h3>Mock-–æ–±—ä–µ–∫—Ç</h3>
        <blockquote cite="https://ru.wikipedia.org/wiki/Mock-%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82">
             (–æ—Ç –∞–Ω–≥–ª. mock object, –±—É–∫–≤–∞–ª—å–Ω–æ: ¬´–æ–±—ä–µ–∫—Ç-–ø–∞—Ä–æ–¥–∏—è¬ª,
             ¬´–æ–±—ä–µ–∫—Ç-–∏–º–∏—Ç–∞—Ü–∏—è¬ª, –∞ —Ç–∞–∫–∂–µ ¬´–ø–æ–¥—Å—Ç–∞–≤–∫–∞¬ª) ‚Äî —Ç–∏–ø –æ–±—ä–µ–∫—Ç–æ–≤,
             —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö –∑–∞–¥–∞–Ω–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –º–æ–¥–µ–ª–∏—Ä—É–µ–º–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
        </blockquote>
    </section>
</section>

<section>
    <section>
        <h3><code>proxyquire</code></h3>
        <p class="fragment">‚≠êÔ∏è 1,588</p>
        <pre class="js fragment console"><code data-trim>
npm install proxyquire --save-dev
        </code></pre>
        <pre class="js fragment"><code data-trim>
const proxyquire =  require('proxyquire');

proxyquire({string} request, {Object} stubs);
        </code></pre>
    </section>

    <section>
        <pre class="js size-S"><code data-trim>
// playPoker.js
const getPokerHand = require('./getPokerHand');
const pokerHands = [/* ... */];

function playPoker(firstDice, secondDice) {
    const first = getPokerHand(firstDice);
    const second = getPokerHand(secondDice);
    const compareHands =
        pokerHands.indexOf(first) -
        pokerHands.indexOf(second);

    return compareHands === 0
        ? '–ù–∏—á—å—è'
        : compareHands > 0 ? '–ü–µ—Ä–≤—ã–π' : '–í—Ç–æ—Ä–æ–π';
}
        </code></pre>
    </section>

    <section>
        <h3><code>proxyquire</code></h3>
        <pre class="js size-S"><code data-trim>
// tests/playPoker-test.js

it('should return `–ù–∏—á—å—è` for equal poker hand', () => {
    const playPoker = proxyquire('../playPoker', {
        './getPokerHand': () => '–ü–∞—Ä–∞'
    });
    const actual = playPoker([1, 1, 2, 3, 4], [1, 1, 2, 3, 4]);

    assert.equal(actual, '–ù–∏—á—å—è');
});
        </code></pre>
    </section>

    <section>
        <h3><code>proxyquire</code></h3>
        <pre class="js size-S"><code data-trim>
// tests/playPoker-test.js

it('should return `–ü–µ—Ä–≤—ã–π` when first hand great', () => {
    const answers = ['–ö–∞—Ä–µ', '–¢—Ä–æ–π–∫–∞']
    const playPoker = proxyquire('../playPoker', {
        './getPokerHand': () => answers.shift()
    });
    const actual = playPoker([1, 1, 1, 1, 4], [1, 1, 1, 3, 4]);

    assert.equal(actual, '–ü–µ—Ä–≤—ã–π');
});
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>Sinon stub</h3>
        <blockquote cite="http://sinonjs.org/releases/v2.1.0/stubs/">
            Test stubs are functions with pre-programmed behavior.
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">Sinon stub</span> –£—Å—Ç–∞–Ω–æ–≤–∫–∞</h3>
        <pre class="js console"><code data-trim>
npm install sinon --save-dev
        </code></pre>
        <pre class="js fragment"><code data-trim>
const sinon = require('sinon');
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon stub</span> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</h3>
        <pre class="js size-S"><code data-trim>
const getPokerHand = sinon.stub();

getPokerHand.withArgs([1, 1, 2, 3, 4]).returns('–ü–∞—Ä–∞');
getPokerHand.withArgs([1, 1, 2, 3, 5]).returns('–ü–∞—Ä–∞');
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon stub</span> –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
// tests/playPoker-test.js

it('should return `–ù–∏—á—å—è` for equal poker hand', () => {
    const getPokerHand = sinon.stub();
    getPokerHand.withArgs([1, 1, 2, 3, 4]).returns('–ü–∞—Ä–∞');
    getPokerHand.withArgs([1, 1, 2, 3, 5]).returns('–ü–∞—Ä–∞');

    const playPoker = proxyquire('../playPoker', {
        './getPokerHand': getPokerHand
    });
    const actual = playPoker([1, 1, 2, 3, 4], [1, 1, 2, 3, 5]);

    assert.equal(actual, '–ù–∏—á—å—è');
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon stub</span> –¢–µ—Å—Ç</h3>
        <pre class="js console"><code data-trim>
playPoker
  ‚úì should return `–ù–∏—á—å—è` for equal poker hand


1 passing (13ms)
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon stub</span> –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim data-noescape>
// tests/playPoker-test.js

it('should return `–ù–∏—á—å—è` for equal poker hand', () => {
    const getPokerHand = sinon.stub();
    getPokerHand.withArgs([1, 1, 2, 3, 4]).returns('–ü–∞—Ä–∞');
    getPokerHand.withArgs([1, 1, 2, 3, 5]).returns('–ü–∞—Ä–∞');
    <span class="fragment grow">getPokerHand.throws('Illegal arguments');</span>

    const playPoker = proxyquire('../playPoker', {
        './getPokerHand': getPokerHand
    });
    const actual = playPoker([1, 1, 2, 3, 4], [1, 1, 2, 3, 6]);

    assert.equal(actual, '–ù–∏—á—å—è');
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon stub</span> –¢–µ—Å—Ç</h3>
        <pre class="js console"><code data-trim>
playPoker
  1) should return `–ù–∏—á—å—è` for equal poker hand


0 passing (12ms)
1 failing

1) playPoker should return `–ù–∏—á—å—è` for equal poker hand:

Illegal arguments
    at Context.it (tests/playPoker-test.js:10:22)
        </code></pre>
    </section>
</section>

<section>
    <section>
        <blockquote>
–í—ã–≤–µ—Å—Ç–∏ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã.
        </blockquote>
    </section>

    <section>
        <h3>–†–µ—à–µ–Ω–∏–µ</h3>
        <pre class="js"><code data-trim>
// poker.js

const playPoker = require('./playPoker');

function poker(firstDice, secondDice) {
    try {
        const result = playPoker(firstDice, secondDice);

        console.log(result);
    } catch(error) {
        console.error(error.message);
    }
}
        </code></pre>
    </section>

    <section>
        <h3>Sinon spy</h3>
        <blockquote cite="http://sinonjs.org/releases/v2.1.0/spies/">
            A test spy is a function that records arguments,
            return value, the value of this and exception thrown
            for all its calls.
        </blockquote>
    </section>

    <section>
        <h3><span class="gray">Sinon spy</span> –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
// tests/poker-test.js

it('should print success result', () => {
    const log = sinon.spy(console, 'log');
    const error = sinon.spy(console, 'error');

    /* ... */
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon spy</span> –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
it('should print success result', () => {
    /* ... */

    const playPoker = sinon.stub();
    playPoker
        .withArgs([1, 2, 3, 4, 5], [1, 2, 3, 4, 6])
        .returns('–ù–∏—á—å—è');
    const poker = proxyquire('../poker', {
        './playPoker': playPoker
    });

    poker([1, 2, 3, 4, 5], [1, 2, 3, 4, 6]);

    /* ... */
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon spy</span> –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
it('should print success result', () => {
    /* ... */

    assert(log.calledOnce);
    assert(log.calledWith('–ù–∏—á—å—è'));

    assert(!error.called);
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon spy</span> –¢–µ—Å—Ç</h3>
        <pre class="js size-S"><code data-trim>
afterEach(() => {
    console.log.restore();
    console.error.restore();
});
        </code></pre>
    </section>

    <section>
        <h3><span class="gray">Sinon spy</span> –ó–∞–ø—É—Å–∫–∞–µ–º</h3>
        <pre class="js console"><code data-trim>
    Poker
  –ù–∏—á—å—è
      ‚úì should print success result


    1 passing (13ms)
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>spy Vs stub</h3>
        <pre class="js size-S"><code data-trim>
it('should print success result', () => {
    const log = sinon.stub(console, 'log');
    const error = sinon.stub(console, 'error');

    /* ... */
}
        </code></pre>
    </section>

    <section>
        <h3>spy Vs stub</h3>
        <pre class="js console"><code data-trim>
    Poker


2 passing (28ms)
        </code></pre>
    </section>
</section>

<section>
    <section>
        <blockquote>
            –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –≤ –∫–æ–Ω—Å–æ–ª–∏
        </blockquote>
    </section>

    <section>
        <pre class="bash"><code>curl http://wttr.in/ekaterinburg</code></pre>
        <img src="images/weather.jpg" alt="weather" class="fragment">
    </section>

    <section>
        <h3>–†–µ—à–µ–Ω–∏–µ</h3>
        <pre class="js size-S"><code data-trim>
// weather.js

const request = require('request');
const url = 'https://api.weather.yandex.ru/v1/forecast';
        </code></pre>

        <p><a href="https://api.weather.yandex.ru/v1/forecast">https://api.weather.yandex.ru/v1/forecast</a></p>
    </section>

    <section>
        <h3>–†–µ—à–µ–Ω–∏–µ</h3>
        <pre class="js size-S"><code data-trim>
function weather(cb) {
    request(url, (requestError, res, body) => {
        if (requestError || res.statusCode !== 200) {
            return cb(requestError.message);
        }

        try {
            const data = JSON.parse(body);
            cb(null, data.fact.temp);
        } catch (parseError) {
            cb(parseError);
        }
    });
}
        </code></pre>
    </section>

    <section>
        <h3><code>nock</code></h3>
        <pre class="js console"><code data-trim>
npm install nock --save-dev
        </code></pre>

        <pre class="js"><code data-trim>
nock('https://api.weather.yandex.ru')
    .get('/v1/forecast')
    .reply(200, '{"fact":{"temp":25}}');
        </code></pre>
    </section>

    <section>
        <h3><code>nock</code></h3>
        <pre class="js size-S"><code data-trim>
// tests/weather-test.js

it('should print temperature', done => {
    nock('https://api.weather.yandex.ru')
        .get('/v1/forecast')
        .reply(200, '{"fact":{"temp":25}}');

    weather((error, actual) => {
        assert.equal(actual, 25);
        done(error);
    });
});
        </code></pre>
    </section>

    <section>
        <h3><code>nock</code></h3>
        <pre class="js size-S"><code data-trim>
// tests/weather-test.js

it('should return error when request failed', done => {
    nock('https://api.weather.yandex.ru')
        .get('/v1/forecast')
        .reply(500, 'Internal server error');

    weather((error, actual) => {
        assert.equal(error, 'Request failed');
        done();
    });
});
        </code></pre>
    </section>

    <section>
        <h3><code>nock</code></h3>
        <pre class="js size-S"><code data-trim>
// tests/weather-test.js

afterEach(nock.cleanAll);
        </code></pre>
    </section>
</section>

<section>
    <h3>–ü–æ—á–∏—Ç–∞—Ç—å</h3>
    <ul>
        <li><a href="https://habrahabr.ru/post/314994/">TDD –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</a></li>
        <li><a href="https://github.com/thlorenz/proxyquire">proxyquire</a></li>
        <li><a href="http://sinonjs.org/">sinonjs.org</a></li>
        <li><a href="https://github.com/node-nock/nock">nock</a></li>
        <li><a href="https://github.com/urfu-2016/qa-task-04">–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ</a></li>
    </ul>
</section>

</div></div>

<script src="../js/head.min.js"></script>
<script src="../js/reveal.js"></script>

<script>
// More info https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    controls: false,
    slideNumber: 'c',
    history: true,
    margin: 0,
    width: 960,
    height: 700,

    // More info https://github.com/hakimel/reveal.js#dependencies
    dependencies: [
        { src: '../plugin/notes/notes.js', async: true },
        { src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
    ]
});
</script>
</body>
</html>
